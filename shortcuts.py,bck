from wagtail.images.models import SourceImageIOError


def get_reform_or_not_found(image, filter_id):
    """
    Tries to get / create the reform for the image or renders a not-found image if it does not exist.
    :param image: AbstractImage instance
    :param specs: str or Filter
    :return: Reform
    """
    try:
        return image.get_reform(filter_id)
    except SourceImageIOError:
        # Image file is (probably) missing from /media/original_images - generate a dummy
        # reform so that we just output a broken image, rather than crashing out completely
        # during rendering.
        # pick up any custom Image / Reform classes that may be in use
        Reform = image.reforms.model  
        reform = Reform(src=image)
        reform.src.name = 'unfound'
        return reform
